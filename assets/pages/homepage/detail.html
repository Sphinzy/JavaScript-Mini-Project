
<!DOCTYPE html>
<html lang="en">
<head>
 <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Blogify</title>

  <!-- Bootstrap -->
  <link rel="stylesheet" href="../../bootstrap-5.3.7/css/bootstrap.css" />

  <!-- Custom CSS -->
  <link rel="stylesheet" href="../../css/style.css" />
  <link rel="stylesheet" href="../../css/style.css">

  <!-- Icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css"/>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css"/>

  <!-- Font -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Poppins&display=swap" rel="stylesheet" />
</head>
<body>

  <!-- <div class="container mt-4">
    <a href="home.html" class="btn btn-secondary mb-3"><i class="fas fa-arrow-left"></i> Back</a>
    
    <div id="article-detail" class="card">
     
    </div>
  </div> -->

  <header>
  <nav class="bg-secondary-subtle">
    <div class="container">
      <div class="navbar flex-column flex-md-row gap-2">
  <a class="navbar-brand fw-bold fs-3">Blogify</a>
  <input type="text" class="form-control w-100 w-md-50" placeholder="Search..." />
</div>

    </div>
  </nav>
</header>

<main>
<section>
<div class="container">
<div class="row">

<!-- LEFT MENU -->
<!-- <div class="col-md-3 d-none d-lg-block">
  <ul class="navbar-nav mt-5">
    <li class="nav-item"><a class="nav-link fs-5">Home</a></li>
    <li class="nav-item"><a class="nav-link fs-5">Feed</a></li>
    <li class="nav-item"><a class="nav-link fs-5">Profile</a></li>
    <li class="nav-item"><a class="nav-link fs-5">Create</a></li>
  </ul>
</div> -->

<!-- POSTS -->
<div class="col-md-12 col-lg-12 my-4">
    <a href="home.html" class="btn btn-secondary mb-3"><i class="fas fa-arrow-left"></i> Back</a>
  <div class="row card-insert">
    <!-- POSTS FROM API ONLY -->
  </div>

  <div id="loader" class="text-center my-4" style="display:none;">
    Loading more posts...
  </div>
</div>

</div>
</div>
</section>
</main>

  <script>
    const baseUrl = "http://blogs.csm.linkpc.net/api/v1";
    const token = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOjMxMiwiaWF0IjoxNzY2NzQxNDY3LCJleHAiOjE3NjczNDYyNjd9.sLRJ3Bj6nSXFFu_JiNDHPDXlz1uUEZYv_hlbBqsocWs';
    // Get article ID from URL query, e.g., article.html?id=123
    const params = new URLSearchParams(window.location.search);
    const articleId = params.get("id");

    const articleDiv = document.getElementById("article-detail");

    if (!articleId) {
      articleDiv.innerHTML = '<div class="card-body"><p>Article not found.</p></div>';
    } else {
      fetch(`${baseUrl}/articles/${articleId}`, {
        headers: {
          Authorization: `Bearer ${token}`
        }
      })
      .then(res => res.json())
      .then(resData => {
        console.log(resData);
        const article = resData.data;
        const creatorObj = {
        id: article.creator?.id || null,
        firstName: article.creator?.firstName || "",
        lastName: article.creator?.lastName || "",
        avatar: article.creator?.avatar || "assets/default-avatar.png"
      };
      localStorage.setItem("profileUser", JSON.stringify(creatorObj));



      document.querySelector('.card-insert').innerHTML = `
  <div class="card-body">
    <div class="row g-4">

      <div class="col-12 col-lg-6">
        <img 
          src="${article.thumbnail}" 
          class="img-fluid rounded w-100"
          style="height: 450px; object-fit: cover;"
        >
      </div>

      <div class="col-12 col-lg-6">

        <!-- AVATAR + NAME -->
        <div class="d-flex align-items-center mb-2">
          <a href="UserProfile.html?id=${creatorObj.id}"
        class="d-flex align-items-center text-decoration-none text-dark">

            <img 
              src="${creatorObj.avatar}" 
              class="rounded-circle me-2"
              width="45" height="45"
            >

            <div>
              <strong>${creatorObj.firstName} ${creatorObj.lastName}</strong><br>
              <small class="text-muted">
                ${article.createdAt ? new Date(article.createdAt).toLocaleString() : ""}
              </small>
            </div>

          </a>
        </div>

       <span class="badge bg-secondary mb-2">
          ${article.category?.name || "Uncategorized"}
        </span>

        <h3 class="mt-2">${article.title}</h3>

        <div class="mt-3">
          ${article.content || article.description || ""}
        </div>

      </div>

    </div>
  </div>
`;


      })
      .catch(err => {
        console.error(err);
        articleDiv.innerHTML = '<div class="card-body"><p>Failed to load article.</p></div>';
      });
    }
  </script>

</body>
</html>
