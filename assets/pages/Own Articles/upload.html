<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manage Thumbnail</title>
</head>

<body>

    <h2>Manage Thumbnail</h2>

    <form id="thumbnailForm">
        <label>Thumbnail</label><br>
        <input type="file" id="thumbnail" accept="image/*" required><br><br>
        <button type="submit">Upload / Edit</button>
        <button type="button" id="deleteBtn">Delete</button>
    </form>

    <script>
        const baseUrl = "http://blogs.csm.linkpc.n`et/api/v1";
        const articleId = 1661;
        const token = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOjEwMDksImlhdCI6MTc2NjQ3NDY0NCwiZXhwIjoxNzY3MDc5NDQ0fQ.tA6xOdsridxDINBTRPi224QXpHFJcysnetMUCTjvMl4";

        const thumbnailForm = document.getElementById("thumbnailForm");
        const fileInput = document.getElementById("thumbnail");
        const deleteBtn = document.getElementById("deleteBtn");

        // Upload / Edit thumbnail
        thumbnailForm.addEventListener("submit", function (e) {
            e.preventDefault();

            if (fileInput.files.length === 0) {
                alert("Please select an image");
                return;
            }

            let formData = new FormData();
            formData.append("thumbnail", fileInput.files[0]);

            fetch(`${baseUrl}/articles/${articleId}/thumbnail`, {
                method: "POST",
                headers: {
                    "Authorization": `Bearer ${token}`
                },
                body: formData
            })
                .then(async res => {
                    const data = await res.json();
                    if (!res.ok) throw data;
                    return data;
                })
                .then(data => {
                    console.log(data);
                    alert("Thumbnail uploaded/updated successfully!");
                })
                .catch(err => {
                    console.error(err);
                    alert(err.message || "Upload failed");
                });
        });

        // Delete thumbnail
        deleteBtn.addEventListener("click", function () {
            if (!confirm("Are you sure you want to delete the thumbnail?")) return;

            fetch(`${baseUrl}/articles/${articleId}/thumbnail`, {
                method: "DELETE",
                headers: {
                    "Authorization": `Bearer ${token}`
                }
            })
                .then(async res => {
                    const data = await res.json();
                    if (!res.ok) throw data;
                    return data;
                })
                .then(data => {
                    console.log(data);
                    alert("Thumbnail deleted successfully!");
                    fileInput.value = "";
                })
                .catch(err => {
                    console.error(err);
                    alert(err.message || "Delete failed");
                });
        });
    </script>

</body>

</html>
